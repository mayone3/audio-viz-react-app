(this["webpackJsonpaudio-viz-react-app"]=this["webpackJsonpaudio-viz-react-app"]||[]).push([[0],{13:function(t,e,a){t.exports=a(29)},27:function(t,e,a){t.exports=a.p+"static/media/marching_illini_11s.d0d9f8eb.wav"},28:function(t,e,a){},29:function(t,e,a){"use strict";a.r(e);var s=a(3),i=a(4),n=a(2),r=a(5),l=a(6),o=a(0),c=a.n(o),h=a(12),u=a.n(h),d=a(7),m=a.n(d),f=a(1),p=a.n(f),v=function(t){Object(l.a)(a,t);var e=Object(r.a)(a);function a(t){var i;return Object(s.a)(this,a),(i=e.call(this,t)).state={aList:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],aIdx:10,fArr:[261.63,277.18,293.66,311.13,329.63,349.23,369.99,392,415.3,440,466.16,493.88,523.25],f:100,aCIdx:10,fC:1e3,bufferSize:65536,sampleRate:65536,numPoints:1e3,w:t.w,h:t.h,v:t.v},i.startAudio=i.startAudio.bind(Object(n.a)(i)),i.stopAudio=i.stopAudio.bind(Object(n.a)(i)),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.audioContext=new(window.AudioContext||window.webkitAudioContext)}},{key:"componentWillUnmount",value:function(){this.stopAudio()}},{key:"componentWillReceiveProps",value:function(t){this.setState({w:t.w,h:t.h,v:t.v})}},{key:"getTimeDomainData",value:function(){for(var t=new Float64Array(this.state.bufferSize).fill(0),e=new Float64Array(this.state.bufferSize).fill(0),a=new Float64Array(this.state.bufferSize).fill(0),s=new Float64Array(this.state.bufferSize).fill(0),i=this.state.aList[this.state.aIdx],n=this.state.f,r=this.state.aList[this.state.aCIdx],l=this.state.fC,o=0;o<this.state.bufferSize;++o)t[o]=o/this.state.sampleRate,e[o]=i*Math.sin(2*Math.PI*n*t[o]);for(var c=0;c<this.state.bufferSize;++c)a[c]=r*Math.sin(2*Math.PI*l*t[c]);if(0!==r)for(var h=0;h<this.state.bufferSize;++h)s[h]=(1+e[h]/r)*a[h]/2;else s=a;return{x:t,yD:e,yC:a,y:s}}},{key:"handleClick",value:function(t){"inca"===t.target.id?this.setState((function(t){return{aIdx:t.aIdx>=t.aList.length-1?t.aIdx:t.aIdx+1}})):"deca"===t.target.id?this.setState((function(t){return{aIdx:t.aIdx<=0?t.aIdx:t.aIdx-1}})):"incf"===t.target.id?this.setState((function(t){return{f:t.f>=800?t.f:t.f+50}})):"decf"===t.target.id?this.setState((function(t){return{f:t.f<=50?t.f:t.f-50}})):"incac"===t.target.id?this.setState((function(t){return{aCIdx:t.aCIdx>=t.aList.length-1?t.aCIdx:t.aCIdx+1}})):"decac"===t.target.id?this.setState((function(t){return{aCIdx:t.aCIdx<=1?t.aCIdx:t.aCIdx-1}})):"incfc"===t.target.id?this.setState((function(t){return{fC:t.fC>=2e3?t.fC:t.fC+100}})):"decfc"===t.target.id&&this.setState((function(t){return{fC:t.fC<=400?t.fC:t.fC-100}}))}},{key:"stopAudio",value:function(){this.audioSource&&this.audioSource.stop()}},{key:"startAudio",value:function(){for(var t=this.getTimeDomainData().y,e=new Float32Array(t.length),a=0;a<t.length;a++)e[a]=t[a];var s=this.audioContext.createBuffer(1,e.length,this.state.sampleRate);s.copyToChannel(e,0),this.audioSource=this.audioContext.createBufferSource(),this.audioSource.buffer=s;var i=this.audioContext.createGain();i.gain.value=this.state.v/200,this.audioSource.connect(i),i.connect(this.audioContext.destination),this.audioSource.start(0)}},{key:"playAudio",value:function(){this.stopAudio(),this.startAudio()}},{key:"render",value:function(){var t=this,e=this.getTimeDomainData(),a=e.x,s=e.y,i=e.yD,n=e.yC,r=this.state.numPoints,l=new m.a.FFT(this.state.bufferSize,this.state.sampleRate);l.forward(e.y.slice(0,this.state.bufferSize));for(var o=l.spectrum,h=Array(o.length).fill(0),u=0;u<h.length;++u)h[u]=this.state.sampleRate/this.state.bufferSize*u;var d,f,v,y=[{x:a.slice(0,r-1),y:i.slice(0,r-1)}],b=[{x:a.slice(0,r-1),y:n.slice(0,r-1)}],g=[{x:a.slice(0,r-1),y:s.slice(0,r-1)}],E=[{x:h.slice(0,2625/(this.state.sampleRate/this.state.bufferSize)),y:o.slice(0,2625/(this.state.sampleRate/this.state.bufferSize))}];this.state.w>=1200?(d=570,v=10):this.state.w>=992?(d=480,v=9):this.state.w>=768?(d=360,v=8):this.state.w>=576?(d=540,v=10):(d=this.state.w-20,v=Math.min(10,this.state.w/40));var w={width:d,height:f=3*d/8+120,title:"Data Wave (Time Domain)",yaxis:{range:[-1,1]},margin:0,font:{size:v}},N={width:d,height:f,title:"Carrier Wave (Time Domain)",yaxis:{range:[-1,1]},margin:0,font:{size:v}},S={width:d,height:f,title:"AM Wave (Time Domain)",yaxis:{range:[-1,1]},margin:0,font:{size:v}},x={width:d,height:f,title:"AM Wave (Frequency Domain)",margin:0,font:{size:v}};return console.log("window resized to: ",this.state.w,"x",this.state.h),console.log("plot resized to: ",d,"x",f),c.a.createElement("div",{className:"container",style:{margin:"auto"}},c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-sm"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-sm col-auto"},c.a.createElement("div",{className:"text-data"},"Data",c.a.createElement("br",null),"Amplitude",c.a.createElement("br",null),this.state.aList[this.state.aIdx]),c.a.createElement("button",{id:"deca",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inca",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-sm col-auto"},c.a.createElement("div",{className:"text-data"},"Data",c.a.createElement("br",null),"Frequency(Hz)",c.a.createElement("br",null),this.state.f),c.a.createElement("button",{id:"decf",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"incf",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))))),c.a.createElement("div",{className:"col-sm"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-sm col-auto"},c.a.createElement("div",{className:"text-data"},"Carrier",c.a.createElement("br",null),"Amplitude",c.a.createElement("br",null),this.state.aList[this.state.aCIdx]),c.a.createElement("button",{id:"decac",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"incac",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-sm col-auto"},c.a.createElement("div",{className:"text-data"},"Carrier",c.a.createElement("br",null),"Frequency(Hz)",c.a.createElement("br",null),this.state.fC),c.a.createElement("button",{id:"decfc",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"incfc",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+")))))),c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-sm"},c.a.createElement("button",{className:"btn btn-dark",onClick:function(e){return t.playAudio(e)}},c.a.createElement("div",{className:"text-btn"},"play audio")))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:y,layout:w,config:{responsive:1}})),c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:b,layout:N,config:{responsive:1}}))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:g,layout:S,config:{responsive:1}})),c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:E,layout:x,config:{responsive:1}}))))}}]),a}(c.a.Component),y=function(t){Object(l.a)(a,t);var e=Object(r.a)(a);function a(t){var i;return Object(s.a)(this,a),(i=e.call(this,t)).state={f:100,fC:1e3,fDev:400,bufferSize:65536,sampleRate:65536,numPoints:1e3,w:t.w,h:t.h,v:t.v},i.startAudio=i.startAudio.bind(Object(n.a)(i)),i.stopAudio=i.stopAudio.bind(Object(n.a)(i)),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.audioContext=new(window.AudioContext||window.webkitAudioContext)}},{key:"componentWillUnmount",value:function(){this.stopAudio()}},{key:"componentWillReceiveProps",value:function(t){this.setState({w:t.w,h:t.h,v:t.v})}},{key:"getTimeDomainData",value:function(){for(var t=new Float64Array(this.state.sampleRate).fill(0),e=new Float64Array(this.state.sampleRate).fill(0),a=new Float64Array(this.state.sampleRate).fill(0),s=new Float64Array(this.state.sampleRate).fill(0),i=this.state.f,n=this.state.fC,r=this.state.fDev,l=0;l<this.state.sampleRate;++l)t[l]=l/this.state.sampleRate,e[l]=Math.sin(2*Math.PI*i*t[l]);for(var o=0;o<this.state.sampleRate;++o)a[o]=Math.sin(2*Math.PI*n*t[o]);for(var c=0;c<this.state.sampleRate;++c)s[c]=Math.cos(2*Math.PI*n*t[c]+r/i*Math.sin(2*Math.PI*i*t[c]));return{x:t,yD:e,yC:a,y:s}}},{key:"handleClick",value:function(t){"incf"===t.target.id?this.setState((function(t){return{f:t.f>=1e3?t.f:t.f+50}})):"decf"===t.target.id?this.setState((function(t){return{f:t.f<=50?t.f:t.f-50}})):"incfc"===t.target.id?this.setState((function(t){return{fC:t.fC>=2e3?t.fC:t.fC+100}})):"decfc"===t.target.id?this.setState((function(t){return{fC:t.fC<=200?t.fC:t.fC-100}})):"incfdev"===t.target.id?this.setState((function(t){return{fDev:t.fDev>=800?t.fDev:t.fDev+25}})):"decfdev"===t.target.id&&this.setState((function(t){return{fDev:t.fDev<=0?t.fDev:t.fDev-25}}))}},{key:"stopAudio",value:function(){this.audioSource&&this.audioSource.stop()}},{key:"startAudio",value:function(){for(var t=this.getTimeDomainData().y,e=new Float32Array(t.length),a=0;a<t.length;a++)e[a]=t[a];var s=this.audioContext.createBuffer(1,e.length,this.state.sampleRate);s.copyToChannel(e,0),this.audioSource=this.audioContext.createBufferSource(),this.audioSource.buffer=s;var i=this.audioContext.createGain();i.gain.value=this.state.v/200,this.audioSource.connect(i),i.connect(this.audioContext.destination),this.audioSource.start(0)}},{key:"playAudio",value:function(){this.stopAudio(),this.startAudio()}},{key:"render",value:function(){var t=this,e=this.getTimeDomainData(),a=e.x,s=e.y,i=e.yD,n=e.yC,r=this.state.numPoints,l=new m.a.FFT(this.state.bufferSize,this.state.sampleRate);l.forward(e.y.slice(0,this.state.bufferSize));for(var o=l.spectrum,h=Array(o.length).fill(0),u=0;u<h.length;++u)h[u]=this.state.sampleRate/this.state.bufferSize*u;var d,f,v,y=[{x:a.slice(0,r-1),y:i.slice(0,r-1)}],b=[{x:a.slice(0,r-1),y:n.slice(0,r-1)}],g=[{x:a.slice(0,r-1),y:s.slice(0,r-1)}],E=[{x:h.slice(0,2625/(this.state.sampleRate/this.state.bufferSize)),y:o.slice(0,2625/(this.state.sampleRate/this.state.bufferSize))}];this.state.w>=1200?(d=570,v=10):this.state.w>=992?(d=480,v=9):this.state.w>=768?(d=360,v=8):this.state.w>=576?(d=540,v=10):(d=this.state.w-20,v=Math.min(10,this.state.w/40));var w={width:d,height:f=3*d/8+120,title:"Data Wave (Time Domain)",yaxis:{range:[-1,1]},margin:0,font:{size:v}},N={width:d,height:f,title:"Carrier Wave (Time Domain)",yaxis:{range:[-1,1]},margin:0,font:{size:v}},S={width:d,height:f,title:"FM Wave (Time Domain)",yaxis:{range:[-1,1]},margin:0,font:{size:v}},x={width:d,height:f,title:"FM Wave (Frequency Domain)",margin:0,font:{size:v}};return console.log("window resized to: ",this.state.w,"x",this.state.h),console.log("plot resized to: ",d,"x",f),c.a.createElement("div",{className:"container",style:{margin:"auto"}},c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-md"},c.a.createElement("div",{className:"text-data"},"Baseband Frequency(Hz)"),c.a.createElement("div",{className:"text-data"},this.state.f),c.a.createElement("button",{id:"decf",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"incf",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-md text-center"},c.a.createElement("div",{className:"text-data"},"Carrier Frequency(Hz)"),c.a.createElement("div",{className:"text-data"},this.state.fC),c.a.createElement("button",{id:"decfc",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"incfc",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-md text-center"},c.a.createElement("div",{className:"text-data"},"FM Deviation(Hz)"),c.a.createElement("div",{className:"text-data"},this.state.fDev),c.a.createElement("button",{id:"decfdev",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"incfdev",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+")))),c.a.createElement("div",{className:"row text-center app-row"},c.a.createElement("div",{className:"col-sm text-center"},c.a.createElement("button",{className:"btn btn-dark",onClick:function(e){return t.playAudio(e)}},c.a.createElement("div",{className:"text-btn"},"play audio")))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:y,layout:w,config:{responsive:1}})),c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:b,layout:N,config:{responsive:1}}))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:g,layout:S,config:{responsive:1}})),c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:E,layout:x,config:{responsive:1}}))))}}]),a}(c.a.Component),b=a(8);function g(t,e,a,s,i){var n,r,l,o,c,h,u,d,m,f,p;i=Math.min(i,2*s);var v=e.slice();switch(n=1/(2*Math.PI*s),r=1/a,t){case 1:l=r/(n+r);break;case 2:l=n/(n+r);break;case 3:var y=1/(2*Math.PI*(s+i/2)),g=1/(2*Math.PI*(s-i/2));o=r/(y+r),c=g/(g+r);break;case 4:i=Math.log((s+i/2)/Math.max(1,s-i/2));var E=Math.pow(10,.5),w=2*Math.PI*s/a,N=Math.cos(w),S=Math.sin(w);o=(1+(l=S*Math.sinh(Math.log(2)/2*i*w/S))/E)/(f=1+l/E),c=-2*N/f,h=(1-l/E)/f,u=(1+l*E)/f,d=-2*N/f,m=(1-l*E)/f}switch(t){case 1:v[0]=l*e[0];for(var x=1;x<e.length;++x)v[x]=v[x-1]+l*(e[x]-v[x-1]);break;case 2:v[0]=e[0];for(var C=1;C<e.length;++C)v[C]=l*(v[C-1]+e[C]-e[C-1]);break;case 3:v[0]=o*e[0];for(var k=1;k<e.length;++k)v[k]=v[k-1]+o*(e[k]-v[k-1]);e=v.slice(),v[0]=e[0];for(var A=1;A<e.length;++A)v[A]=c*(v[A-1]+e[A]-e[A-1]);(p=Math.max.apply(Math,Object(b.a)(v)))>=1&&(v=v.map((function(t){return t/p})));break;case 4:v[0]=u*e[0],v[1]=u*e[1]+d*e[0]-c*v[0];for(var F=2;F<e.length;++F)v[F]=u*e[F]+d*e[F-1]+m*e[F-2]-c*v[F-1]-h*v[F-2];(p=Math.max.apply(Math,Object(b.a)(v)))>=1&&(v=v.map((function(t){return t/p})))}return v}var E=function(t){Object(l.a)(a,t);var e=Object(r.a)(a);function a(t){var i;return Object(s.a)(this,a),(i=e.call(this,t)).state={aList:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],aIdx:10,fIdx:49,f:440,bufferSize:65536,sampleRate:65536,numPoints:1e3,noiseAIdx:10,noiseList:["NONE","WHITE","PINK"],noiseType:0,filterList:["NONE","LOWPASS","HIGHPASS","BANDPASS","BELL"],filterType:0,filterCutoff:500,filterBandwidth:100,audioContext:new(window.AudioContext||window.webkitAudioContext),audioSource:null,x:new Float64Array(65536),y:new Float64Array(65536),noise:new Float64Array(65536),w:t.w,h:t.h,v:t.v},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var t=this,e=this.state.x.map((function(e,a){return a/t.state.sampleRate})),a=this.state.y.map((function(a,s){return t.state.aList[t.state.aIdx]*Math.sin(2*Math.PI*t.state.f*e[s])}));this.setState({x:e,y:a})}},{key:"componentWillReceiveProps",value:function(t){this.setState({w:t.w,h:t.h,v:t.v})}},{key:"getTimeDomainData",value:function(){var t=this,e=this.state.x,a=this.state.y,s=Math.max(this.state.aList[this.state.aIdx]+this.state.aList[this.state.noiseAIdx]*(0!==this.state.noiseType),1);return a=a.map((function(e,a){return(e+t.state.noise[a])/s})),{x:e,y:a=g(this.state.filterType,a,this.state.sampleRate,this.state.filterCutoff,this.state.filterBandwidth)}}},{key:"updateSignal",value:function(t){var e=this,a=this.state.aIdx,s=this.state.fIdx,i=this.state.f;"inc-a"===t.target.id?a=a>=this.state.aList.length-1?a:a+1:"dec-a"===t.target.id?a=a<=0?a:a-1:"inc-f"===t.target.id?(s=s>=88?s:s+1,i=440*Math.pow(2,(s-49)/12)):"dec-f"===t.target.id&&(s=s<=1?s:s-1,i=440*Math.pow(2,(s-49)/12));var n=new Float64Array(this.state.bufferSize);n=n.map((function(t,s){return e.state.aList[a]*Math.sin(2*Math.PI*i*e.state.x[s])})),this.setState({aIdx:a,fIdx:s,f:i,y:n})}},{key:"updateNoise",value:function(t){var e=this,a=this.state.noiseAIdx,s=this.state.noiseType,i=this.state.noise;if("inc-noisea"===t.target.id)a=a>=this.state.aList.length-1?a:a+1;else if("dec-noisea"===t.target.id)a=a<=1?a:a-1;else if("next-noise"===t.target.id){if(0===(s=(s+1)%this.state.noiseList.length))i=i.map((function(t){return 0}));else if(1===s)i=i.map((function(t){return 2*(Math.random()-.5)}));else if(2===s){var n=g(1,i=i.map((function(t){return 2*(Math.random()-.5)})),this.state.sampleRate,39,0),r=g(1,i,this.state.sampleRate,399,0),l=g(1,i,this.state.sampleRate,3990,0);i=i.map((function(t,e){return n[e]+.7*r[e]+.4*l[e]}));var o=Math.max.apply(Math,Object(b.a)(i));i=i.map((function(t){return t/o}))}}else if("prev-noise"===t.target.id)if(0===(s=s>0?s-1:this.state.noiseList.length-1))i=i.map((function(t){return 0}));else if(1===s)i=i.map((function(t){return 2*(Math.random()-.5)}));else if(2===s){var c=g(1,i=i.map((function(t){return 2*(Math.random()-.5)})),this.state.sampleRate,39,0),h=g(1,i,this.state.sampleRate,399,0),u=g(1,i,this.state.sampleRate,3990,0);i=i.map((function(t,e){return c[e]+.7*h[e]+.4*u[e]}));var d=Math.max.apply(Math,Object(b.a)(i));i=i.map((function(t){return t/d}))}if(0!==s){var m=Math.max.apply(Math,Object(b.a)(i));i=i.map((function(t){return t/m*e.state.aList[a]}))}this.setState({noiseAIdx:a,noiseType:s,noise:i})}},{key:"updateFilter",value:function(t){var e=this.state.filterType,a=this.state.filterCutoff,s=this.state.filterBandwidth;"next-filter"===t.target.id?e=(e+1)%this.state.filterList.length:"prev-filter"===t.target.id?e=e>0?e-1:this.state.filterList.length-1:"inc-cutoff"===t.target.id?a=1===a?50:a>=2e3?a:a+50:"dec-cutoff"===t.target.id?a=a<=100?100:a-50:"inc-bw"===t.target.id?s=1===s?50:s>=1e3?s:s+50:"dec-bw"===t.target.id&&(s=s<=50?50:s-50),this.setState({filterType:e,filterCutoff:a,filterBandwidth:s})}},{key:"handleClick",value:function(t){this.updateSignal(t),this.updateNoise(t),this.updateFilter(t)}},{key:"stopAudio",value:function(){console.log("stopAudio()"),null!==this.state.audioSource&&this.state.audioSource.stop()}},{key:"startAudio",value:function(){console.log("startAudio()");for(var t=this.getTimeDomainData().y,e=new Float32Array(t.length),a=0;a<t.length;a++)e[a]=t[a];var s=this.state.audioContext.createBuffer(1,e.length,this.state.sampleRate);s.getChannelData(0).set(e);var i=this.state.audioContext.createBufferSource();i.buffer=s;var n=this.state.audioContext.createGain();n.gain.value=this.state.v/100,i.connect(n),n.connect(this.state.audioContext.destination),i.start(0),this.state.audioSource=i,console.log(i)}},{key:"playAudio",value:function(){console.log("playAudio()"),this.stopAudio(),this.startAudio()}},{key:"render",value:function(){var t=this,e=this.getTimeDomainData(),a=e.x,s=e.y,i=this.state.numPoints,n=new m.a.FFT(this.state.bufferSize,this.state.sampleRate);n.forward(e.y.slice(0,this.state.bufferSize));for(var r=n.spectrum,l=Array(r.length).fill(0),o=0;o<l.length;++o)l[o]=this.state.sampleRate/this.state.bufferSize*o;var h,u,d,f=Math.max(2125,this.state.f+525),v=[{x:a.slice(0,i-1),y:s.slice(0,i-1)}],y=[{x:l.slice(0,f/(this.state.sampleRate/this.state.bufferSize)),y:r.slice(0,f/(this.state.sampleRate/this.state.bufferSize))}];this.state.w>=1200?(h=570,d=10):this.state.w>=992?(h=480,d=9):this.state.w>=768?(h=360,d=8):this.state.w>=576?(h=540,d=10):(h=this.state.w-20,d=Math.min(10,this.state.w/40));var b={width:h,height:u=3*h/8+120,title:"Time Domain",yaxis:{range:[-1,1]},margin:0,font:{size:d}},g={width:h,height:u,title:"Frequency Domain",margin:0,font:{size:d}};return console.log("window resized to: ",this.state.w,"x",this.state.h),console.log("plot resized to: ",h,"x",u),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-sm"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-sm-6 col"},c.a.createElement("div",{className:"text-data"},"Amplitude",c.a.createElement("br",null),this.state.aList[this.state.aIdx]),c.a.createElement("button",{id:"dec-a",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inc-a",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-sm-6 col"},c.a.createElement("div",{className:"text-data"},"Frequency(Hz)",c.a.createElement("br",null),this.state.f.toFixed(2)),c.a.createElement("button",{id:"dec-f",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inc-f",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))))),c.a.createElement("div",{className:"col-sm"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-sm-6 col"},c.a.createElement("div",{className:"text-data"},"Noise Amplitude",c.a.createElement("br",null),this.state.aList[this.state.noiseAIdx]),c.a.createElement("button",{id:"dec-noisea",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inc-noisea",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-sm-6 col"},c.a.createElement("div",{className:"text-data"},"Noise Type",c.a.createElement("br",null),this.state.noiseList[this.state.noiseType]),c.a.createElement("button",{id:"prev-noise",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"\u2190")),c.a.createElement("button",{id:"next-noise",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"\u2192")))))),c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-sm"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-sm-4 col"},c.a.createElement("div",{className:"text-data"},"Filter Type",c.a.createElement("br",null),this.state.filterList[this.state.filterType]),c.a.createElement("button",{id:"prev-filter",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"\u2190")),c.a.createElement("button",{id:"next-filter",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"\u2192"))),c.a.createElement("div",{className:"col-sm-4 col"},c.a.createElement("div",{className:"text-data"},"Filter Cutoff (Hz)",c.a.createElement("br",null),this.state.filterCutoff),c.a.createElement("button",{id:"dec-cutoff",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inc-cutoff",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-sm-4 col"},c.a.createElement("div",{className:"text-data"},"Filter Bandwidth (Hz)",c.a.createElement("br",null),this.state.filterBandwidth),c.a.createElement("button",{id:"dec-bw",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inc-bw",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+")))))),c.a.createElement("div",{className:"row app-row justify-content-center"},c.a.createElement("div",{className:"col-sm col-auto"},c.a.createElement("button",{className:"btn btn-dark",onClick:function(e){return t.playAudio(e)}},c.a.createElement("div",{className:"text-btn"},"play")))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:v,layout:b,config:{responsive:1}})),c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:y,layout:g,config:{responsive:1}}))))}}]),a}(c.a.Component),w=function(t){Object(l.a)(a,t);var e=Object(r.a)(a);function a(t){var i;return Object(s.a)(this,a),(i=e.call(this,t)).state={a:[1,0,0,0,1,0,0,1,0,0,0,0,1],aList:[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],f:[261.63,277.18,293.66,311.13,329.63,349.23,369.99,392,415.3,440,466.16,493.88,523.25],bufferSize:65536,sampleRate:65536,numPoints:1e3,noiseAIdx:1,noiseList:["NONE","WHITE","PINK"],noiseType:0,filterList:["NONE","LOWPASS","HIGHPASS","BANDPASS","BELL"],filterType:0,filterCutoff:600,filterBandwidth:100,audioContext:new(window.AudioContext||window.webkitAudioContext),audioSource:null,x:new Float64Array(65536),y:new Float64Array(65536),noise:new Float64Array(65536),w:t.w,h:t.h,v:t.v},i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){for(var t=this,e=this.state.x.map((function(e,a){return a/t.state.sampleRate})),a=new Float64Array(this.state.bufferSize).fill(0),s=new Float64Array(this.state.bufferSize).fill(0),i=this.state.a,n=0;n<a.length;++n)for(var r=0;r<this.state.f.length;++r)a[n]+=i[r]*Math.sin(2*Math.PI*this.state.f[r]*e[n]);for(var l=0,o=0;o<i.length;++o)l+=1*(0!==i[o]);for(var c=0;c<a.length;++c)a[c]/=l;this.setState({x:e,y:a,noise:s})}},{key:"componentWillReceiveProps",value:function(t){this.setState({w:t.w,h:t.h,v:t.v})}},{key:"getTimeDomainData",value:function(){var t=this,e=this.state.x,a=this.state.y,s=1+this.state.aList[this.state.noiseAIdx]*(0!==this.state.noiseType);return a=a.map((function(e,a){return(e+t.state.noise[a])/s})),{x:e,y:a=g(this.state.filterType,a,this.state.sampleRate,this.state.filterCutoff,this.state.filterBandwidth)}}},{key:"updateSignal",value:function(t){var e=new Float64Array(this.state.bufferSize).fill(0),a=this.state.a;a[t.target.id.slice(10)]=t.target.value;for(var s=0;s<e.length;++s)for(var i=0;i<this.state.f.length;++i)e[s]+=a[i]*Math.sin(2*Math.PI*this.state.f[i]*this.state.x[s]);for(var n=0,r=0;r<a.length;++r)n+=1*(0!==a[r]);for(var l=0;l<e.length;++l)e[l]/=n;this.setState({a:a,y:e})}},{key:"updateNoise",value:function(t){var e=this,a=this.state.noiseAIdx,s=this.state.noiseType,i=this.state.noise;if("inc-noisea"===t.target.id)a=a>=this.state.aList.length-1?a:a+1;else if("dec-noisea"===t.target.id)a=a<=1?a:a-1;else if("next-noise"===t.target.id){if(0===(s=(s+1)%this.state.noiseList.length))i=i.map((function(t){return 0}));else if(1===s)i=i.map((function(t){return 2*(Math.random()-.5)}));else if(2===s){var n=g(1,i=i.map((function(t){return 2*(Math.random()-.5)})),this.state.sampleRate,39,0),r=g(1,i,this.state.sampleRate,399,0),l=g(1,i,this.state.sampleRate,3990,0);i=i.map((function(t,e){return n[e]+.7*r[e]+.4*l[e]}));var o=Math.max.apply(Math,Object(b.a)(i));i=i.map((function(t){return t/o}))}}else if("prev-noise"===t.target.id)if(0===(s=s>0?s-1:this.state.noiseList.length-1))i=i.map((function(t){return 0}));else if(1===s)i=i.map((function(t){return 2*(Math.random()-.5)}));else if(2===s){var c=g(1,i=i.map((function(t){return 2*(Math.random()-.5)})),this.state.sampleRate,39,0),h=g(1,i,this.state.sampleRate,399,0),u=g(1,i,this.state.sampleRate,3990,0);i=i.map((function(t,e){return c[e]+.7*h[e]+.4*u[e]}));var d=Math.max.apply(Math,Object(b.a)(i));i=i.map((function(t){return t/d}))}if(0!==s){var m=Math.max.apply(Math,Object(b.a)(i));i=i.map((function(t){return t/m*e.state.aList[a]}))}this.setState({noiseAIdx:a,noiseType:s,noise:i})}},{key:"updateFilter",value:function(t){var e=this.state.filterType,a=this.state.filterCutoff,s=this.state.filterBandwidth;"next-filter"===t.target.id?e=(e+1)%this.state.filterList.length:"prev-filter"===t.target.id?e=e>0?e-1:this.state.filterList.length-1:"inc-cutoff"===t.target.id?a=1===a?50:a>=2e3?a:a+50:"dec-cutoff"===t.target.id?a=a<=100?100:a-50:"inc-bw"===t.target.id?s=1===s?50:s>=1e3?s:s+50:"dec-bw"===t.target.id&&(s=s<=50?50:s-50),this.setState({filterType:e,filterCutoff:a,filterBandwidth:s})}},{key:"handleClick",value:function(t){this.updateNoise(t),this.updateFilter(t)}},{key:"handleChange",value:function(t){this.updateSignal(t)}},{key:"stopAudio",value:function(){console.log("stopAudio()"),null!==this.state.audioSource&&this.state.audioSource.stop()}},{key:"startAudio",value:function(){console.log("startAudio()");for(var t=this.getTimeDomainData().y,e=new Float32Array(t.length),a=0;a<t.length;a++)e[a]=t[a];var s=this.state.audioContext.createBuffer(1,e.length,this.state.sampleRate);s.getChannelData(0).set(e);var i=this.state.audioContext.createBufferSource();i.buffer=s;var n=this.state.audioContext.createGain();n.gain.value=this.state.v/100,i.connect(n),n.connect(this.state.audioContext.destination),i.start(0),this.state.audioSource=i,console.log(i)}},{key:"playAudio",value:function(){console.log("playAudio()"),this.stopAudio(),this.startAudio()}},{key:"render",value:function(){var t=this,e=this.getTimeDomainData(),a=e.x,s=e.y,i=this.state.numPoints,n=new m.a.FFT(this.state.bufferSize,this.state.sampleRate);n.forward(e.y.slice(0,this.state.bufferSize));for(var r=n.spectrum,l=Array(r.length).fill(0),o=0;o<l.length;++o)l[o]=this.state.sampleRate/this.state.bufferSize*o;var h,u,d,f=[{x:a.slice(0,i-1),y:s.slice(0,i-1)}],v=[{x:l.slice(0,725/(this.state.sampleRate/this.state.bufferSize)),y:r.slice(0,725/(this.state.sampleRate/this.state.bufferSize))}];this.state.w>=1200?(h=570,d=10):this.state.w>=992?(h=480,d=9):this.state.w>=768?(h=360,d=8):this.state.w>=576?(h=540,d=10):(h=this.state.w-20,d=Math.min(10,this.state.w/40));var y={width:h,height:u=3*h/8+120,title:"Time Domain",yaxis:{range:[-1,1]},margin:0,font:{size:d}},b={width:h,height:u,title:"Frequency Domain",margin:0,font:{size:d}};return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row",style:{marginTop:"5px",marginBottom:"20px"}},c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"C",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-0",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[0],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"C#",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-1",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[1],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"D",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-2",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[2],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"D#",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-3",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[3],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"E",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-4",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[4],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"F",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-5",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[5],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"F#",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-6",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[6],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"G",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-7",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[7],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"G#",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-8",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[8],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"A",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-9",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[9],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"A#",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-10",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[10],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"B",c.a.createElement("sub",null,"4")),c.a.createElement("input",{id:"multifreq-11",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[11],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"})),c.a.createElement("div",{className:"col-sm col-auto",style:{marginBottom:"20px"}},c.a.createElement("div",{className:"text-key"},"C",c.a.createElement("sub",null,"5")),c.a.createElement("input",{id:"multifreq-12",className:"custom-range no-border vslider",type:"range",onChange:function(e){return t.handleChange(e)},value:this.state.a[12],min:"0.0",max:"1.0",step:"0.1",orientation:"vertical"}))),c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-sm col"},c.a.createElement("div",{className:"text-data"},"Noise Amplitude",c.a.createElement("br",null),this.state.aList[this.state.noiseAIdx]),c.a.createElement("button",{id:"dec-noisea",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inc-noisea",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-sm col"},c.a.createElement("div",{className:"text-data"},"Noise Type",c.a.createElement("br",null),this.state.noiseList[this.state.noiseType]),c.a.createElement("button",{id:"prev-noise",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"\u2190")),c.a.createElement("button",{id:"next-noise",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"\u2192"))),c.a.createElement("div",{className:"col-sm col"},c.a.createElement("div",{className:"text-data"},"Filter Type",c.a.createElement("br",null),this.state.filterList[this.state.filterType]),c.a.createElement("button",{id:"prev-filter",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"\u2190")),c.a.createElement("button",{id:"next-filter",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"\u2192"))),c.a.createElement("div",{className:"col-sm col"},c.a.createElement("div",{className:"text-data"},"Filter Cutoff (Hz)",c.a.createElement("br",null),this.state.filterCutoff),c.a.createElement("button",{id:"dec-cutoff",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inc-cutoff",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+"))),c.a.createElement("div",{className:"col-sm col"},c.a.createElement("div",{className:"text-data"},"Filter Bandwidth (Hz)",c.a.createElement("br",null),this.state.filterBandwidth),c.a.createElement("button",{id:"dec-bw",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"-")),c.a.createElement("button",{id:"inc-bw",type:"button",className:"btn btn-dark",onClick:function(e){return t.handleClick(e)}},c.a.createElement("div",{className:"text-btn"},"+")))),c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-sm"},c.a.createElement("button",{className:"btn btn-dark",onClick:function(e){return t.playAudio(e)}},c.a.createElement("div",{className:"text-btn"},"play")))),c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-md plot-col"},c.a.createElement(p.a,{data:f,layout:y,config:{responsive:1}})),c.a.createElement("div",{className:"col-md plot-col"},c.a.createElement(p.a,{data:v,layout:b,config:{responsive:1}}))))}}]),a}(c.a.Component),N=a(9),S=a.n(N),x=a(10),C=function(t){Object(l.a)(a,t);var e=Object(r.a)(a);function a(t){var i;return Object(s.a)(this,a),(i=e.call(this,t)).state={timeData:new Float32Array(0),freqData:new Float32Array(0),outputConnected:!1,w:t.w,h:t.h,v:t.v},i.tick=i.tick.bind(Object(n.a)(i)),i.audioContext=new(window.AudioContext||window.webkitAudioContext),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=16384,this.analyser.smoothingTimeConstant=.25,this.source=this.audioContext.createMediaStreamSource(this.props.audio),this.source.connect(this.analyser),this.gainNode=this.audioContext.createGain(),this.source.connect(this.gainNode),this.dataArray=new Float32Array(this.analyser.frequencyBinCount),this.freqArray=new Float32Array(this.analyser.frequencyBinCount),this.rafId=requestAnimationFrame(this.tick)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rafId),this.source.disconnect(),this.analyser.disconnect()}},{key:"componentWillReceiveProps",value:function(t){this.setState({w:t.w,h:t.h,v:t.v})}},{key:"tick",value:function(){this.rafId=requestAnimationFrame(this.tick),this.analyser.getFloatTimeDomainData(this.dataArray),this.analyser.getFloatFrequencyData(this.freqArray),this.setState({timeData:this.dataArray,freqData:this.freqArray}),!1===this.props.muted?(this.gainNode.gain.value=this.state.v/100,this.gainNode.connect(this.audioContext.destination),this.setState({outputConnected:!0})):this.state.outputConnected&&(this.gainNode.gain.value=this.state.v/100,this.gainNode.disconnect(this.audioContext.destination),this.setState({outputConnected:!1}))}},{key:"render",value:function(){var t,e,a,s=this,i=[{x:this.state.timeData.map((function(t,e){return e/s.audioContext.sampleRate})),y:this.state.timeData}],n=[{x:this.state.freqData.map((function(t,e){return e/s.analyser.frequencyBinCount*s.audioContext.sampleRate/2})),y:this.state.freqData}];this.state.w>=1200?(t=570,a=10):this.state.w>=992?(t=480,a=9):this.state.w>=768?(t=360,a=8):this.state.w>=576?(t=540,a=10):(t=this.state.w-20,a=Math.min(10,this.state.w/40));var r={width:t,height:e=3*t/8+120,title:"Time Domain",yaxis:{range:[-1,1]},margin:0,font:{size:a}},l={width:t,height:e,title:"Frequency Domain",margin:0,font:{size:a}};return c.a.createElement("div",null,c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:i,layout:r,config:{responsive:1}})),c.a.createElement("div",{className:"col-sm plot-col"},c.a.createElement(p.a,{data:n,layout:l,config:{responsive:1}}))))}}]),a}(c.a.Component),k=function(t){Object(l.a)(a,t);var e=Object(r.a)(a);function a(t){var i;return Object(s.a)(this,a),(i=e.call(this,t)).state={filterList:["NONE","LOWPASS","HIGHPASS","BANDPASS","BELL"],filterType:0,audio:null,audioData:new Uint8Array(0),muted:!0,w:t.w,h:t.h,v:t.v},i}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(t){this.setState({w:t.w,h:t.h,v:t.v})}},{key:"getMicrophone",value:function(){var t=Object(x.a)(S.a.mark((function t(){var e;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({audio:!0,video:!1});case 2:e=t.sent,this.setState({audio:e});case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"stopMicrophone",value:function(){this.state.audio.getTracks().forEach((function(t){return t.stop()})),this.setState({audio:null})}},{key:"toggleMicrophone",value:function(){this.state.audio?this.stopMicrophone():this.getMicrophone()}},{key:"toggleMute",value:function(){this.state.muted?this.setState({muted:!1}):this.setState({muted:!0})}},{key:"render",value:function(){var t=this;return c.a.createElement("div",{className:"app-container"},c.a.createElement("div",{className:"row text-center app-row"},c.a.createElement("div",{className:"col-md text-center"},c.a.createElement("button",{id:"mic-toggle-microphone",type:"button",className:"btn btn-dark",onClick:function(e){return t.toggleMicrophone()}},c.a.createElement("div",{className:"text-btn"},this.state.audio?"Stop Microphone":"Start Microphone")))),c.a.createElement("div",{className:"row text-center app-row"},c.a.createElement("div",{className:"col-md text-center"},c.a.createElement("button",{id:"mic-toggle-playing",type:"button",className:"btn btn-dark",onClick:function(e){return t.toggleMute()}},c.a.createElement("div",{className:"text-btn"},this.state.muted?"Unmute Echo":"Mute Echo")))),this.state.audio?c.a.createElement(C,{audio:this.state.audio,muted:this.state.muted,w:this.state.w,h:this.state.h,v:this.state.v}):c.a.createElement("div",null))}}]),a}(c.a.Component),A=function(t){Object(l.a)(o,t);var e=Object(r.a)(o);function o(t){var a;return Object(s.a)(this,o),(a=e.call(this,t)).state={quality:4,compressed:!1,audio:null,timeData:new Float32Array(0),playing:!1,chunkSize:4096,originalSourceReady:!1,compressedSourceReady:!1,generatingCompressedAudio:!1,generatedCompressedAudio:!1,compressedLoadingProgress:"",v:t.v},a.onFileChange=a.onFileChange.bind(Object(n.a)(a)),a.loadOriginalSource=a.loadOriginalSource.bind(Object(n.a)(a)),a.loadCompressedSource=a.loadCompressedSource.bind(Object(n.a)(a)),a.loadCompressedSourceCallback=a.loadCompressedSourceCallback.bind(Object(n.a)(a)),a.tick=a.tick.bind(Object(n.a)(a)),a}return Object(i.a)(o,[{key:"componentDidMount",value:function(){this.audioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:44100}),this.rafId=requestAnimationFrame(this.tick),this.createAudioFile()}},{key:"createAudioFile",value:function(){var t=Object(x.a)(S.a.mark((function t(){var e,s;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.audioURL=a(27),this.audio=new Audio(this.audioURL),this.audio.addEventListener("canplaythrough",this.loadOriginalSource,!0),(e=new XMLHttpRequest).open("GET",this.audioURL,!0),e.responseType="blob",s=this,e.onload=function(){s.audioFile=new File([e.response],"marching_illini.wav")},e.send();case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(t){this.setState({v:t.v}),console.log(t.v),this.compressedGainNode&&(this.compressedGainNode.gain.value=t.v/100),this.audio&&(this.audio.volume=t.v/100)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rafId),this.state.playing&&this.stopPlaying(),this.source&&this.source.disconnect(),this.analyser&&this.analyser.disconnect(),this.compressedSource&&this.compressedSource.disconnect(),this.compressedGainNode&&this.compressedGainNode.disconnect(),this.audio&&(this.audio.removeEventListener("canplaythrough",this.loadOriginalSource,!0),this.audio=null),this.audioStream&&(this.audioStream=null)}},{key:"onFileChange",value:function(t){t.target.files[0]&&(this.state.playing&&this.stopPlaying(),this.audio&&(this.audio.removeEventListener("canplaythrough",this.loadOriginalSource,!0),this.audio=null),this.setState({originalSourceReady:!1,compressedSourceReady:!1,generatedCompressedAudio:!1,compressedLoadingProgress:""}),this.audioFile=t.target.files[0],this.audioURL=URL.createObjectURL(this.audioFile),this.audio=new Audio(this.audioURL),this.audio.volume=this.state.v/100,this.audio.addEventListener("canplaythrough",this.loadOriginalSource,!0))}},{key:"loadOriginalSource",value:function(){this.audioStream=this.audio.captureStream(),this.source=this.audioContext.createMediaStreamSource(this.audioStream),this.analyser=this.audioContext.createAnalyser(),this.dataArray=new Float32Array(this.analyser.frequencyBinCount),this.freqArray=new Float32Array(this.analyser.frequencyBinCount),this.source.connect(this.analyser),this.audio.muted=this.state.compressed,this.setState({originalSourceReady:!0})}},{key:"loadCompressedSource",value:function(){if(this.audio)if(this.audioFile)if(this.state.generatedCompressedAudio)alert("Compressed audio already generated.");else if(this.state.generatingCompressedAudio)alert("Please wait until compression finishes.");else{var t=new FileReader;t.onload=this.loadCompressedSourceCallback,t.readAsArrayBuffer(this.audioFile)}else alert("No audio file");else alert("Please upload an audio file!")}},{key:"loadCompressedSourceCallback",value:function(){var t=Object(x.a)(S.a.mark((function t(e){var a,s=this;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({generatingCompressedAudio:!0}),t.next=3,new Promise((function(t){return setTimeout(t)}));case 3:a=e.target.result,this.audioContext.decodeAudioData(a).then(function(){var t=Object(x.a)(S.a.mark((function t(e){var a,i,n,r,l,o,c,h,u,d,f,p,v,y,b,g,E;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.getChannelData(0),i=new Float32Array(a.length),n=0;case 3:if(!(n<a.length/s.state.chunkSize)){t.next=30;break}if(n%64!==0){t.next=8;break}return s.setState({compressedLoadingProgress:(n/(a.length/s.state.chunkSize)*100).toFixed(2)+"%"}),t.next=8,new Promise((function(t){return setTimeout(t)}));case 8:for(r=n*s.state.chunkSize,l=Math.min(a.length-r,s.state.chunkSize),o=new Float32Array(s.state.chunkSize).fill(0),c=0;c<l;++c)o[c]=a[r+c];for((h=new m.a.FFT(s.state.chunkSize,s.audioContext.sampleRate)).forward(o),u=h.spectrum,d=h.real,f=h.imag,(p=u.map((function(t,e){return e}))).sort((function(t,e){return u[t]>u[e]?-1:u[t]<u[e]?1:0})),v=s.state.quality,y=new Float32Array(l).fill(0),b=new Float32Array(d.length).fill(0),g=new Float32Array(f.length).fill(0),E=0;E<v;++E)b[p[E]]=d[p[E]],g[p[E]]=f[p[E]],b[d.length-p[E]]=d[d.length-p[E]],g[f.length-p[E]]=f[f.length-p[E]];(y=h.inverse(b,g)).length!==l&&(y=y.slice(0,l)),i.set(y,r);case 27:++n,t.next=3;break;case 30:s.compressedAudioBuffer=s.audioContext.createBuffer(1,i.length,s.audioContext.sampleRate),s.compressedAudioBuffer.copyToChannel(i,0),s.setState({compressedSourceReady:!0,compressedLoadingProgress:"100%",generatingCompressedAudio:!1,generatedCompressedAudio:!0});case 33:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"onQualityChange",value:function(t){this.state.generatedCompressedAudio?(this.state.playing&&this.stopPlaying(),this.compressedAudioBuffer=null,this.setState({quality:t.target.value,generatedCompressedAudio:!1,compressedSourceReady:!1,compressedLoadingProgress:""})):this.state.generatingCompressedAudio?alert("Generating compressed audio, please change this later"):this.setState({quality:t.target.value})}},{key:"tick",value:function(){this.rafId=requestAnimationFrame(this.tick),this.state.playing&&(this.analyser.getFloatTimeDomainData(this.dataArray),this.analyser.getFloatFrequencyData(this.freqArray),this.setState({timeData:this.dataArray,freqData:this.freqArray}),this.audio.currentTime===this.audio.duration&&this.stopPlaying())}},{key:"startPlaying",value:function(){this.audio?this.state.originalSourceReady?!this.state.compressedSourceReady&&this.state.generatingCompressedAudio?alert("Please wait for compressed audio finishes generating"):this.state.compressedSourceReady||this.state.generatingCompressedAudio?(this.compressedSource=this.audioContext.createBufferSource(),this.compressedSource.buffer=this.compressedAudioBuffer,this.compressedGainNode=this.audioContext.createGain(),this.compressedSource.connect(this.compressedGainNode),this.compressedGainNode.connect(this.audioContext.destination),this.state.compressed?this.compressedGainNode.gain.value=this.state.v/200:this.compressedGainNode.gain.value=0,this.compressedSource.start(),this.audio.play(),this.setState({playing:!0})):alert("Please generate compressed audio"):alert("Please wait for audio ready"):alert("Please upload an audio file!")}},{key:"stopPlaying",value:function(){this.audio.pause(),this.audio.currentTime=0,this.compressedSource.stop(),this.compressedSource.disconnect(),this.compressedGainNode.disconnect(),this.setState({playing:!1})}},{key:"togglePlaying",value:function(){this.state.playing?this.stopPlaying():this.startPlaying()}},{key:"startCompress",value:function(){this.compressedSource&&(this.compressedGainNode.gain.value=this.state.v/200),this.audio&&(this.audio.muted=!0),this.setState({compressed:!0})}},{key:"stopCompress",value:function(){this.compressedSource&&(this.compressedGainNode.gain.value=0),this.audio&&(this.audio.muted=!1),this.setState({compressed:!1})}},{key:"toggleCompress",value:function(){this.state.compressed?this.stopCompress():this.startCompress()}},{key:"render",value:function(){var t=this;return c.a.createElement("div",{className:"container",style:{margin:"auto"}},c.a.createElement("div",{className:"row justify-content-center app-row"},c.a.createElement("div",{className:"col-xs text-center"},c.a.createElement("div",{className:"input-group"},c.a.createElement("div",{className:"input-group-prepend"},c.a.createElement("span",{className:"input-group-text text-data"},"Upload")),c.a.createElement("div",{className:"custom-file"},c.a.createElement("label",{id:"input-file-label",className:"custom-file-label text-data",style:{width:"auto"}},this.audioFile?this.audioFile.name:"Choose File"),c.a.createElement("input",{className:"custom-file-input",type:"file",accept:"audio/wav",style:{width:"auto"},onChange:function(e){return t.onFileChange(e)}}))))),c.a.createElement("div",{className:"row justify-content-center app-row"},c.a.createElement("div",{className:"col-sm align-self-center",style:{maxWidth:"150px"}},c.a.createElement("div",{className:"text-data"},"Quality:")),c.a.createElement("div",{className:"col-sm",style:{maxWidth:"150px"}},c.a.createElement("select",{className:"form-control text-data",id:"compress-quality-dropdown-menu",onChange:function(e){return t.onQualityChange(e)},value:this.state.quality,style:{width:"auto"}},c.a.createElement("option",{value:1,className:"text-data"},"1"),c.a.createElement("option",{value:2,className:"text-data"},"2"),c.a.createElement("option",{value:4,className:"text-data"},"4"),c.a.createElement("option",{value:8,className:"text-data"},"8"),c.a.createElement("option",{value:16,className:"text-data"},"16"),c.a.createElement("option",{value:32,className:"text-data"},"32"),c.a.createElement("option",{value:64,className:"text-data"},"64"),c.a.createElement("option",{value:128,className:"text-data"},"128"),c.a.createElement("option",{value:256,className:"text-data"},"256")))),c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-md text-center"},c.a.createElement("button",{type:"button",className:"btn btn-dark",onClick:this.loadCompressedSource},c.a.createElement("div",{className:"text-btn"},"Generate Compressed Audio")))),c.a.createElement("div",{className:"row app-row"},c.a.createElement("div",{className:"col-md text-center"},this.audio?c.a.createElement("div",null,c.a.createElement("div",null,this.state.originalSourceReady?c.a.createElement("div",{className:"text-data"},"Original Audio Ready!"):c.a.createElement("div",{className:"text-data"},"Loading Original Source")),c.a.createElement("div",null,this.state.generatedCompressedAudio?c.a.createElement("div",{className:"text-data"},"Compressed Audio Ready!"):this.state.generatingCompressedAudio?c.a.createElement("div",{className:"text-data"},"Loading Compressed Source"):c.a.createElement("div",{className:"text-data"},"Please Generate Compressed Audio")),c.a.createElement("div",{className:"text-data"},this.state.compressedSourceReady?"":this.state.compressedLoadingProgress)):c.a.createElement("div",{className:"text-data"},"Please upload an audio file"))),c.a.createElement("div",{className:"row justify-content-center app-row"},c.a.createElement("div",{className:"col-sm",style:{maxWidth:"200px"}},c.a.createElement("button",{type:"button",className:"btn btn-dark",onClick:function(e){return t.togglePlaying()}},c.a.createElement("div",{className:"text-btn"},this.state.playing?"Stop Playing":"Start Playing"))),c.a.createElement("div",{className:"col-sm",style:{maxWidth:"200px"}},c.a.createElement("button",{type:"button",className:"btn btn-dark",onClick:function(e){return t.toggleCompress()}},c.a.createElement("div",{className:"text-btn"},this.state.compressed?"Play Original":"Play Compressed")))))}}]),o}(c.a.Component),F=(a(28),function(t){Object(l.a)(a,t);var e=Object(r.a)(a);function a(){var t;return Object(s.a)(this,a),(t=e.call(this)).state={appList:["Fixed Frequency Player","Multi Frequency Player","AM Player","FM Player","Microphone","Audio Compressor"],currApp:0,w:window.innerWidth,h:window.innerHeight,v:30},t.handleResize=t.handleResize.bind(Object(n.a)(t)),t}return Object(i.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"getCurrApp",value:function(){switch(this.state.currApp){case 0:return c.a.createElement(E,{w:this.state.w,h:this.state.h,v:this.state.v});case 1:return c.a.createElement(w,{w:this.state.w,h:this.state.h,v:this.state.v});case 2:return c.a.createElement(v,{w:this.state.w,h:this.state.h,v:this.state.v});case 3:return c.a.createElement(y,{w:this.state.w,h:this.state.h,v:this.state.v});case 4:return c.a.createElement(k,{w:this.state.w,h:this.state.h,v:this.state.v});case 5:return c.a.createElement(A,{v:this.state.v});default:return c.a.createElement("div",null,"ERROR")}}},{key:"handleClick",value:function(t){"button-next-app"===t.target.id?this.setState((function(t){return{currApp:(t.currApp+1)%t.appList.length}})):"button-prev-app"===t.target.id&&this.setState((function(t){return{currApp:t.currApp>0?t.currApp-1:t.appList.length-1}}))}},{key:"handleResize",value:function(){this.setState({w:window.innerWidth,h:window.innerHeight})}},{key:"render",value:function(){var t=this;return c.a.createElement("div",{className:"text-center"},c.a.createElement("div",{className:"container",style:{paddingTop:"20px",margin:"auto"}},c.a.createElement("div",{className:"row app-row justify-content-center"},c.a.createElement("div",{className:"col-md"},c.a.createElement("select",{className:"text-data",onChange:function(e){return t.setState({currApp:parseInt(e.target.value)})}},c.a.createElement("option",{value:"0"},"Fixed Frequency Player"),c.a.createElement("option",{value:"1"},"Multi Frequency Player"),c.a.createElement("option",{value:"2"},"AM Player"),c.a.createElement("option",{value:"3"},"FM Player"),c.a.createElement("option",{value:"4"},"Microphone"),c.a.createElement("option",{value:"5"},"Audio Compressor")))),c.a.createElement("div",{className:"row app-row justify-content-center"},c.a.createElement("div",{className:"col-md"},c.a.createElement("div",{className:"text-data"},"Volume"),c.a.createElement("input",{type:"range",onChange:function(e){return t.setState({v:e.target.value})},value:this.state.v,min:"0",max:"100",step:"1"})))),this.getCurrApp())}}]),a}(c.a.Component));u.a.render(c.a.createElement(F,null),document.getElementById("root"))},7:function(t,e,a){(function(t){var e={LEFT:0,RIGHT:1,MIX:2,SINE:1,TRIANGLE:2,SAW:3,SQUARE:4,LOWPASS:0,HIGHPASS:1,BANDPASS:2,NOTCH:3,BARTLETT:1,BARTLETTHANN:2,BLACKMAN:3,COSINE:4,GAUSS:5,HAMMING:6,HANN:7,LANCZOS:8,RECTANGULAR:9,TRIANGULAR:10,OFF:0,FW:1,BW:2,FWBW:3,TWO_PI:2*Math.PI};function a(t,e){"function"!==typeof this[t]&&"object"!==typeof this[t]&&("function"===typeof this[e]&&"object"!==typeof this[e]?this[t]=this[e]:this[t]=function(t){return t instanceof Array?t:"number"===typeof t?new Array(t):void 0})}function s(t,e){this.bufferSize=t,this.sampleRate=e,this.bandwidth=2/t*e/2,this.spectrum=new Float64Array(t/2),this.real=new Float64Array(t),this.imag=new Float64Array(t),this.peakBand=0,this.peak=0,this.getBandFrequency=function(t){return this.bandwidth*t+this.bandwidth/2},this.calculateSpectrum=function(){for(var e,a,s,i=this.spectrum,n=this.real,r=this.imag,l=2/this.bufferSize,o=Math.sqrt,c=0,h=t/2;c<h;c++)(s=l*o((e=n[c])*e+(a=r[c])*a))>this.peak&&(this.peakBand=c,this.peak=s),i[c]=s}}function i(t,e){s.call(this,t,e);var a=t/2*t,i=2*Math.PI;this.sinTable=new Float64Array(a),this.cosTable=new Float64Array(a);for(var n=0;n<a;n++)this.sinTable[n]=Math.sin(n*i/t),this.cosTable[n]=Math.cos(n*i/t)}function n(t,e){s.call(this,t,e),this.reverseTable=new Uint32Array(t);for(var a,i=1,n=t>>1;i<t;){for(a=0;a<i;a++)this.reverseTable[a+i]=this.reverseTable[a]+n;i<<=1,n>>=1}for(this.sinTable=new Float64Array(t),this.cosTable=new Float64Array(t),a=0;a<t;a++)this.sinTable[a]=Math.sin(-Math.PI/a),this.cosTable[a]=Math.cos(-Math.PI/a)}function r(t,e){s.call(this,t,e),this.trans=new Float64Array(t),this.reverseTable=new Uint32Array(t),this.reverseBinPermute=function(t,e){var a,s=this.bufferSize,i=s>>>1,n=s-1,r=1,l=0;t[0]=e[0];do{for(l+=i,t[r]=e[l],t[l]=e[r],r++,a=i<<1;!((l^=a>>=1)&a););l>=r&&(t[r]=e[l],t[l]=e[r],t[n-r]=e[n-l],t[n-l]=e[n-r]),r++}while(r<i);t[n]=e[n]},this.generateReverseTable=function(){var t,e=this.bufferSize,a=e>>>1,s=e-1,i=1,n=0;this.reverseTable[0]=0;do{for(n+=a,this.reverseTable[i]=n,this.reverseTable[n]=i,i++,t=a<<1;!((n^=t>>=1)&t););n>=i&&(this.reverseTable[i]=n,this.reverseTable[n]=i,this.reverseTable[s-i]=s-n,this.reverseTable[s-n]=s-i),i++}while(i<a);this.reverseTable[s]=s},this.generateReverseTable()}function l(t,a,s,i,n,r,l,o){this.file=t,this.bufferSize=a,this.sampleRate=s,this.playStart=i||0,this.playEnd=n||1,this.loopStart=r||0,this.loopEnd=l||1,this.loopMode=o||e.OFF,this.loaded=!1,this.samples=[],this.signal=new Float64Array(a),this.frameCount=0,this.envelope=null,this.amplitude=1,this.rootFrequency=110,this.frequency=550,this.step=this.frequency/this.rootFrequency,this.duration=0,this.samplesProcessed=0,this.playhead=0;var c=document.createElement("AUDIO"),h=this;this.loadSamples=function(t){for(var a=e.getChannel(e.MIX,t.frameBuffer),s=0;s<a.length;s++)h.samples.push(a[s])},this.loadComplete=function(){h.samples=new Float64Array(h.samples),h.loaded=!0},this.loadMetaData=function(){h.duration=c.duration},c.addEventListener("MozAudioAvailable",this.loadSamples,!1),c.addEventListener("loadedmetadata",this.loadMetaData,!1),c.addEventListener("ended",this.loadComplete,!1),c.muted=!0,c.src=t,c.play()}function o(t,a,s,i,n){switch(this.frequency=a,this.amplitude=s,this.bufferSize=i,this.sampleRate=n,this.frameCount=0,this.waveTableLength=2048,this.cyclesPerSample=a/n,this.signal=new Float64Array(i),this.envelope=null,parseInt(t,10)){case e.TRIANGLE:this.func=o.Triangle;break;case e.SAW:this.func=o.Saw;break;case e.SQUARE:this.func=o.Square;break;default:case e.SINE:this.func=o.Sine}this.generateWaveTable=function(){o.waveTable[this.func]=new Float64Array(2048);for(var t=1/(this.waveTableLength/this.sampleRate),e=0;e<this.waveTableLength;e++)o.waveTable[this.func][e]=this.func(e*t/this.sampleRate)},"undefined"===typeof o.waveTable&&(o.waveTable={}),"undefined"===typeof o.waveTable[this.func]&&this.generateWaveTable(),this.waveTable=o.waveTable[this.func]}function c(t,e,a,s,i,n){this.sampleRate=n,this.attackLength=t,this.decayLength=e,this.sustainLevel=a,this.sustainLength=s,this.releaseLength=i,this.sampleRate=n,this.attackSamples=t*n,this.decaySamples=e*n,this.sustainSamples=s*n,this.releaseSamples=i*n,this.update=function(){this.attack=this.attackSamples,this.decay=this.attack+this.decaySamples,this.sustain=this.decay+this.sustainSamples,this.release=this.sustain+this.releaseSamples},this.update(),this.samplesProcessed=0}function h(t,a,s,i){switch(this.sampleRate=i,t){case e.LOWPASS:case e.LP12:this.func=new h.LP12(a,s,i)}}function u(t,e,a,s){this.type=t,this.cutoff=e,this.resonance=a,this.sampleRate=s,this.f=new Float64Array(4),this.f[0]=0,this.f[1]=0,this.f[2]=0,this.f[3]=0,this.calcCoeff=function(t,e){this.freq=2*Math.sin(Math.PI*Math.min(.25,t/(2*this.sampleRate))),this.damp=Math.min(2*(1-Math.pow(e,.25)),Math.min(2,2/this.freq-.5*this.freq))},this.calcCoeff(e,a)}function d(t,a){switch(this.alpha=a,t){case e.BARTLETT:this.func=d.Bartlett;break;case e.BARTLETTHANN:this.func=d.BartlettHann;break;case e.BLACKMAN:this.func=d.Blackman,this.alpha=this.alpha||.16;break;case e.COSINE:this.func=d.Cosine;break;case e.GAUSS:this.func=d.Gauss,this.alpha=this.alpha||.25;break;case e.HAMMING:this.func=d.Hamming;break;case e.HANN:this.func=d.Hann;break;case e.LANCZOS:this.func=d.Lanczoz;break;case e.RECTANGULAR:this.func=d.Rectangular;break;case e.TRIANGULAR:this.func=d.Triangular}}function m(t){return(Math.exp(t)-Math.exp(-t))/2}function f(t,a){this.Fs=a,this.type=t,this.parameterType=e.Q,this.x_1_l=0,this.x_2_l=0,this.y_1_l=0,this.y_2_l=0,this.x_1_r=0,this.x_2_r=0,this.y_1_r=0,this.y_2_r=0,this.b0=1,this.a0=1,this.b1=0,this.a1=0,this.b2=0,this.a2=0,this.b0a0=this.b0/this.a0,this.b1a0=this.b1/this.a0,this.b2a0=this.b2/this.a0,this.a1a0=this.a1/this.a0,this.a2a0=this.a2/this.a0,this.f0=3e3,this.dBgain=12,this.Q=1,this.BW=-3,this.S=1,this.coefficients=function(){return{b:[this.b0,this.b1,this.b2],a:[this.a0,this.a1,this.a2]}},this.setFilterType=function(t){this.type=t,this.recalculateCoefficients()},this.setSampleRate=function(t){this.Fs=t,this.recalculateCoefficients()},this.setQ=function(t){this.parameterType=e.Q,this.Q=Math.max(Math.min(t,115),.001),this.recalculateCoefficients()},this.setBW=function(t){this.parameterType=e.BW,this.BW=t,this.recalculateCoefficients()},this.setS=function(t){this.parameterType=e.S,this.S=Math.max(Math.min(t,5),1e-4),this.recalculateCoefficients()},this.setF0=function(t){this.f0=t,this.recalculateCoefficients()},this.setDbGain=function(t){this.dBgain=t,this.recalculateCoefficients()},this.recalculateCoefficients=function(){var a;a=t===e.PEAKING_EQ||t===e.LOW_SHELF||t===e.HIGH_SHELF?Math.pow(10,this.dBgain/40):Math.sqrt(Math.pow(10,this.dBgain/20));var s,i=e.TWO_PI*this.f0/this.Fs,n=Math.cos(i),r=Math.sin(i),l=0;switch(this.parameterType){case e.Q:l=r/(2*this.Q);break;case e.BW:l=r*m(Math.LN2/2*this.BW*i/r);break;case e.S:l=r/2*Math.sqrt((a+1/a)*(1/this.S-1)+2)}switch(this.type){case e.LPF:this.b0=(1-n)/2,this.b1=1-n,this.b2=(1-n)/2,this.a0=1+l,this.a1=-2*n,this.a2=1-l;break;case e.HPF:this.b0=(1+n)/2,this.b1=-(1+n),this.b2=(1+n)/2,this.a0=1+l,this.a1=-2*n,this.a2=1-l;break;case e.BPF_CONSTANT_SKIRT:this.b0=r/2,this.b1=0,this.b2=-r/2,this.a0=1+l,this.a1=-2*n,this.a2=1-l;break;case e.BPF_CONSTANT_PEAK:this.b0=l,this.b1=0,this.b2=-l,this.a0=1+l,this.a1=-2*n,this.a2=1-l;break;case e.NOTCH:this.b0=1,this.b1=-2*n,this.b2=1,this.a0=1+l,this.a1=-2*n,this.a2=1-l;break;case e.APF:this.b0=1-l,this.b1=-2*n,this.b2=1+l,this.a0=1+l,this.a1=-2*n,this.a2=1-l;break;case e.PEAKING_EQ:this.b0=1+l*a,this.b1=-2*n,this.b2=1-l*a,this.a0=1+l/a,this.a1=-2*n,this.a2=1-l/a;break;case e.LOW_SHELF:s=r*Math.sqrt((3^a)*(1/this.S-1)+2*a),this.b0=a*(a+1-(a-1)*n+s),this.b1=2*a*(a-1-(a+1)*n),this.b2=a*(a+1-(a-1)*n-s),this.a0=a+1+(a-1)*n+s,this.a1=-2*(a-1+(a+1)*n),this.a2=a+1+(a-1)*n-s;break;case e.HIGH_SHELF:s=r*Math.sqrt((3^a)*(1/this.S-1)+2*a),this.b0=a*(a+1+(a-1)*n+s),this.b1=-2*a*(a-1+(a+1)*n),this.b2=a*(a+1+(a-1)*n-s),this.a0=a+1-(a-1)*n+s,this.a1=2*(a-1-(a+1)*n),this.a2=a+1-(a-1)*n-s}this.b0a0=this.b0/this.a0,this.b1a0=this.b1/this.a0,this.b2a0=this.b2/this.a0,this.a1a0=this.a1/this.a0,this.a2a0=this.a2/this.a0},this.process=function(t){for(var e=t.length,a=new Float64Array(e),s=0;s<t.length;s++)a[s]=this.b0a0*t[s]+this.b1a0*this.x_1_l+this.b2a0*this.x_2_l-this.a1a0*this.y_1_l-this.a2a0*this.y_2_l,this.y_2_l=this.y_1_l,this.y_1_l=a[s],this.x_2_l=this.x_1_l,this.x_1_l=t[s];return a},this.processStereo=function(t){for(var e=t.length,a=new Float64Array(e),s=0;s<e/2;s++)a[2*s]=this.b0a0*t[2*s]+this.b1a0*this.x_1_l+this.b2a0*this.x_2_l-this.a1a0*this.y_1_l-this.a2a0*this.y_2_l,this.y_2_l=this.y_1_l,this.y_1_l=a[2*s],this.x_2_l=this.x_1_l,this.x_1_l=t[2*s],a[2*s+1]=this.b0a0*t[2*s+1]+this.b1a0*this.x_1_r+this.b2a0*this.x_2_r-this.a1a0*this.y_1_r-this.a2a0*this.y_2_r,this.y_2_r=this.y_1_r,this.y_1_r=a[2*s+1],this.x_2_r=this.x_1_r,this.x_1_r=t[2*s+1];return a}}function p(t,e,a,s){this.delayBufferSamples=new Float64Array(t),this.delayInputPointer=e,this.delayOutputPointer=0,this.delayInSamples=e,this.masterVolume=a,this.delayVolume=s}function v(t,e,a){this.delayBufferSamples=new Float64Array(t),this.delayInputPointer=e,this.delayOutputPointer=0,this.delayInSamples=e,this.delayVolume=a}function y(t,a,s,i,n,r){var l,o;for(this.delayInSamples=a,this.masterVolume=s,this.mixVolume=i,this.delayVolume=n,this.dampFrequency=r,this.NR_OF_MULTIDELAYS=6,this.NR_OF_SINGLEDELAYS=6,this.LOWPASSL=new u(e.LOWPASS,r,0,44100),this.LOWPASSR=new u(e.LOWPASS,r,0,44100),this.singleDelays=[],l=0;l<this.NR_OF_SINGLEDELAYS;l++)o=1+l/7,this.singleDelays[l]=new v(t,Math.round(this.delayInSamples*o),this.delayVolume);for(this.multiDelays=[],l=0;l<this.NR_OF_MULTIDELAYS;l++)o=1+l/10,this.multiDelays[l]=new p(t,Math.round(this.delayInSamples*o),this.masterVolume,this.delayVolume)}a("Float64Array","WebGLFloatArray"),a("Int32Array","WebGLIntArray"),a("Uint16Array","WebGLUnsignedShortArray"),a("Uint8Array","WebGLUnsignedByteArray"),e.invert=function(t){for(var e=0,a=t.length;e<a;e++)t[e]*=-1;return t},e.interleave=function(t,e){if(t.length!==e.length)throw"Can not interleave. Channel lengths differ.";for(var a=new Float64Array(2*t.length),s=0,i=t.length;s<i;s++)a[2*s]=t[s],a[2*s+1]=e[s];return a},e.deinterleave=function(){var t,a,s,i=[];return i[e.MIX]=function(t){for(var e=0,a=t.length/2;e<a;e++)s[e]=(t[2*e]+t[2*e+1])/2;return s},i[e.LEFT]=function(e){for(var a=0,s=e.length/2;a<s;a++)t[a]=e[2*a];return t},i[e.RIGHT]=function(t){for(var e=0,s=t.length/2;e<s;e++)a[e]=t[2*e+1];return a},function(e,n){return t=t||new Float64Array(n.length/2),a=a||new Float64Array(n.length/2),s=s||new Float64Array(n.length/2),n.length/2!==t.length&&(t=new Float64Array(n.length/2),a=new Float64Array(n.length/2),s=new Float64Array(n.length/2)),i[e](n)}}(),e.getChannel=e.deinterleave,e.mixSampleBuffers=function(t,e,a,s){for(var i=new Float64Array(t),n=0;n<t.length;n++)i[n]+=(a?-e[n]:e[n])/s;return i},e.LPF=0,e.HPF=1,e.BPF_CONSTANT_SKIRT=2,e.BPF_CONSTANT_PEAK=3,e.NOTCH=4,e.APF=5,e.PEAKING_EQ=6,e.LOW_SHELF=7,e.HIGH_SHELF=8,e.Q=1,e.BW=2,e.S=3,e.RMS=function(t){for(var e=0,a=0,s=t.length;a<s;a++)e+=t[a]*t[a];return Math.sqrt(e/s)},e.Peak=function(t){for(var e=0,a=0,s=t.length;a<s;a++)e=Math.abs(t[a])>e?Math.abs(t[a]):e;return e},i.prototype.forward=function(t){for(var e,a,s=this.real,i=this.imag,n=0;n<this.bufferSize/2;n++){e=0,a=0;for(var r=0;r<t.length;r++)e+=this.cosTable[n*r]*t[r],a+=this.sinTable[n*r]*t[r];s[n]=e,i[n]=a}return this.calculateSpectrum()},n.prototype.forward=function(t){var e=this.bufferSize,a=this.cosTable,s=this.sinTable,i=this.reverseTable,n=this.real,r=this.imag,l=(this.spectrum,Math.floor(Math.log(e)/Math.LN2));if(Math.pow(2,l)!==e)throw"Invalid buffer size, must be a power of 2.";if(e!==t.length)throw"Supplied buffer is not the same size as defined FFT. FFT Size: "+e+" Buffer Size: "+t.length;var o,c,h,u,d,m,f,p,v,y=1;for(v=0;v<e;v++)n[v]=t[i[v]],r[v]=0;for(;y<e;){o=a[y],c=s[y],h=1,u=0;for(var b=0;b<y;b++){for(v=b;v<e;)m=h*n[d=v+y]-u*r[d],f=h*r[d]+u*n[d],n[d]=n[v]-m,r[d]=r[v]-f,n[v]+=m,r[v]+=f,v+=y<<1;h=(p=h)*o-u*c,u=p*c+u*o}y<<=1}return this.calculateSpectrum()},n.prototype.inverse=function(t,e){var a=this.bufferSize,s=this.cosTable,i=this.sinTable,n=this.reverseTable;this.spectrum;t=t||this.real,e=e||this.imag;var r,l,o,c,h,u,d,m,f,p=1;for(f=0;f<a;f++)e[f]*=-1;var v=new Float64Array(a),y=new Float64Array(a);for(f=0;f<t.length;f++)v[f]=t[n[f]],y[f]=e[n[f]];for(t=v,e=y;p<a;){r=s[p],l=i[p],o=1,c=0;for(var b=0;b<p;b++){for(f=b;f<a;)u=o*t[h=f+p]-c*e[h],d=o*e[h]+c*t[h],t[h]=t[f]-u,e[h]=e[f]-d,t[f]+=u,e[f]+=d,f+=p<<1;o=(m=o)*r-c*l,c=m*l+c*r}p<<=1}var g=new Float64Array(a);for(f=0;f<a;f++)g[f]=t[f]/a;return g},r.prototype.forward=function(t){var e,a,s,i,n,r,l,o,c,h,u,d,m,f,p,v,y,b,g,E,w,N,S,x,C,k,A=this.bufferSize,F=this.spectrum,P=this.trans,M=2*Math.PI,T=Math.sqrt,L=A>>>1,I=2/A;this.reverseBinPermute(P,t);for(var R=0,O=4;R<A;O*=4){for(var D=R;D<A;D+=O)y=P[D]-P[D+1],P[D]+=P[D+1],P[D+1]=y;R=2*(O-1)}for(e=2,i=A>>>1;i>>>=1;){R=0,O=(e<<=1)<<1,a=e>>>2,s=e>>>3;do{if(1!==a)for(D=R;D<A;D+=O)d=(u=(h=(c=D)+a)+a)+a,n=P[u]+P[d],P[d]-=P[u],P[u]=P[c]-n,P[c]+=n,c+=s,h+=s,d+=s,n=P[u+=s]+P[d],r=P[u]-P[d],n=-n*Math.SQRT1_2,r*=Math.SQRT1_2,y=P[h],P[d]=n+y,P[u]=n-y,P[h]=P[c]-r,P[c]+=r;else for(D=R;D<A;D+=O)d=(u=(h=(c=D)+a)+a)+a,n=P[u]+P[d],P[d]-=P[u],P[u]=P[c]-n,P[c]+=n;R=(O<<1)-e,O<<=2}while(R<A);N=M/e;for(var _=1;_<s;_++){S=_*N,g=Math.sin(S),E=4*(b=Math.cos(S))*(b*b-.75),w=4*g*(.75-g*g),R=0,O=e<<1;do{for(D=R;D<A;D+=O)d=(u=(h=(c=D+_)+a)+a)+a,v=(p=(f=(m=D+a-_)+a)+a)+a,r=P[p]*b-P[u]*g,n=P[p]*g+P[u]*b,o=P[v]*E-P[d]*w,l=P[v]*w+P[d]*E,y=r-o,r+=o,o=y,P[v]=r+P[f],P[u]=r-P[f],y=l-n,n+=l,l=y,P[d]=l+P[h],P[p]=l-P[h],P[f]=P[c]-n,P[c]+=n,P[h]=o+P[m],P[m]-=o;R=(O<<1)-e,O<<=2}while(R<A)}}for(;--L;)(k=I*T((x=P[L])*x+(C=P[A-L-1])*C))>this.peak&&(this.peakBand=L,this.peak=k),F[L]=k;return F[0]=I*P[0],F},l.prototype.applyEnvelope=function(){return this.envelope.process(this.signal),this.signal},l.prototype.generate=function(){this.frameCount,this.bufferSize;for(var t=this.playEnd*this.samples.length-this.playStart*this.samples.length,a=this.playStart*this.samples.length,s=this.playEnd*this.samples.length,i=0;i<this.bufferSize;i++){switch(this.loopMode){case e.OFF:this.playhead=Math.round(this.samplesProcessed*this.step+a),this.playhead<this.playEnd*this.samples.length?this.signal[i]=this.samples[this.playhead]*this.amplitude:this.signal[i]=0;break;case e.FW:this.playhead=Math.round(this.samplesProcessed*this.step%t+a),this.playhead<this.playEnd*this.samples.length&&(this.signal[i]=this.samples[this.playhead]*this.amplitude);break;case e.BW:this.playhead=s-Math.round(this.samplesProcessed*this.step%t),this.playhead<this.playEnd*this.samples.length&&(this.signal[i]=this.samples[this.playhead]*this.amplitude);break;case e.FWBW:Math.floor(this.samplesProcessed*this.step/t)%2===0?this.playhead=Math.round(this.samplesProcessed*this.step%t+a):this.playhead=s-Math.round(this.samplesProcessed*this.step%t),this.playhead<this.playEnd*this.samples.length&&(this.signal[i]=this.samples[this.playhead]*this.amplitude)}this.samplesProcessed++}return this.frameCount++,this.signal},l.prototype.setFreq=function(t){var e=this.samplesProcessed*this.step;this.frequency=t,this.step=this.frequency/this.rootFrequency,this.samplesProcessed=Math.round(e/this.step)},l.prototype.reset=function(){this.samplesProcessed=0,this.playhead=0},o.prototype.setAmp=function(t){if(!(t>=0&&t<=1))throw"Amplitude out of range (0..1).";this.amplitude=t},o.prototype.setFreq=function(t){this.frequency=t,this.cyclesPerSample=t/this.sampleRate},o.prototype.add=function(t){for(var e=0;e<this.bufferSize;e++)this.signal[e]+=t.signal[e];return this.signal},o.prototype.addSignal=function(t){for(var e=0;e<t.length&&!(e>=this.bufferSize);e++)this.signal[e]+=t[e];return this.signal},o.prototype.addEnvelope=function(t){this.envelope=t},o.prototype.applyEnvelope=function(){this.envelope.process(this.signal)},o.prototype.valueAt=function(t){return this.waveTable[t%this.waveTableLength]},o.prototype.generate=function(){for(var t,e=this.frameCount*this.bufferSize,a=this.waveTableLength*this.frequency/this.sampleRate,s=0;s<this.bufferSize;s++)t=Math.round((e+s)*a),this.signal[s]=this.waveTable[t%this.waveTableLength]*this.amplitude;return this.frameCount++,this.signal},o.Sine=function(t){return Math.sin(e.TWO_PI*t)},o.Square=function(t){return t<.5?1:-1},o.Saw=function(t){return 2*(t-Math.round(t))},o.Triangle=function(t){return 1-4*Math.abs(Math.round(t)-t)},o.Pulse=function(t){},c.prototype.noteOn=function(){this.samplesProcessed=0,this.sustainSamples=this.sustainLength*this.sampleRate,this.update()},c.prototype.noteOff=function(){this.sustainSamples=this.samplesProcessed-this.decaySamples,this.update()},c.prototype.processSample=function(t){var e=0;return this.samplesProcessed<=this.attack?e=0+(this.samplesProcessed-0)/(this.attack-0)*1:this.samplesProcessed>this.attack&&this.samplesProcessed<=this.decay?e=1+(this.sustainLevel-1)*((this.samplesProcessed-this.attack)/(this.decay-this.attack)):this.samplesProcessed>this.decay&&this.samplesProcessed<=this.sustain?e=this.sustainLevel:this.samplesProcessed>this.sustain&&this.samplesProcessed<=this.release&&(e=this.sustainLevel+(0-this.sustainLevel)*((this.samplesProcessed-this.sustain)/(this.release-this.sustain))),t*e},c.prototype.value=function(){var t=0;return this.samplesProcessed<=this.attack?t=0+(this.samplesProcessed-0)/(this.attack-0)*1:this.samplesProcessed>this.attack&&this.samplesProcessed<=this.decay?t=1+(this.sustainLevel-1)*((this.samplesProcessed-this.attack)/(this.decay-this.attack)):this.samplesProcessed>this.decay&&this.samplesProcessed<=this.sustain?t=this.sustainLevel:this.samplesProcessed>this.sustain&&this.samplesProcessed<=this.release&&(t=this.sustainLevel+(0-this.sustainLevel)*((this.samplesProcessed-this.sustain)/(this.release-this.sustain))),t},c.prototype.process=function(t){for(var e=0;e<t.length;e++)t[e]*=this.value(),this.samplesProcessed++;return t},c.prototype.isActive=function(){return!(this.samplesProcessed>this.release||-1===this.samplesProcessed)},c.prototype.disable=function(){this.samplesProcessed=-1},h.prototype.__defineGetter__("cutoff",(function(){return this.func.cutoff})),h.prototype.__defineGetter__("resonance",(function(){return this.func.resonance})),h.prototype.set=function(t,e){this.func.calcCoeff(t,e)},h.prototype.process=function(t){this.func.process(t)},h.prototype.addEnvelope=function(t){if(!(t instanceof c))throw"Not an envelope.";this.func.addEnvelope(t)},h.LP12=function(t,e,a){this.sampleRate=a,this.vibraPos=0,this.vibraSpeed=0,this.envelope=!1,this.calcCoeff=function(t,e){this.w=2*Math.PI*t/this.sampleRate,this.q=1-this.w/(2*(e+.5/(1+this.w))+this.w-2),this.r=this.q*this.q,this.c=this.r+1-2*Math.cos(this.w)*this.q,this.cutoff=t,this.resonance=e},this.calcCoeff(t,e),this.process=function(t){for(var e=0;e<t.length;e++)this.vibraSpeed+=(t[e]-this.vibraPos)*this.c,this.vibraPos+=this.vibraSpeed,this.vibraSpeed*=this.r,this.envelope?(t[e]=t[e]*(1-this.envelope.value())+this.vibraPos*this.envelope.value(),this.envelope.samplesProcessed++):t[e]=this.vibraPos}},h.LP12.prototype.addEnvelope=function(t){this.envelope=t},u.prototype.process=function(t){for(var e,a,s=this.f,i=0;i<t.length;i++)e=t[i],s[3]=e-this.damp*s[2],s[0]=s[0]+this.freq*s[2],s[1]=s[3]-s[0],s[2]=this.freq*s[1]+s[2],a=.5*s[this.type],s[3]=e-this.damp*s[2],s[0]=s[0]+this.freq*s[2],s[1]=s[3]-s[0],s[2]=this.freq*s[1]+s[2],a+=.5*s[this.type],this.envelope?(t[i]=t[i]*(1-this.envelope.value())+a*this.envelope.value(),this.envelope.samplesProcessed++):t[i]=a},u.prototype.addEnvelope=function(t){if(!(t instanceof c))throw"This is not an envelope.";this.envelope=t},u.prototype.set=function(t,e){this.calcCoeff(t,e)},d.prototype.process=function(t){for(var e=t.length,a=0;a<e;a++)t[a]*=this.func(e,a,this.alpha);return t},d.Bartlett=function(t,e){return 2/(t-1)*((t-1)/2-Math.abs(e-(t-1)/2))},d.BartlettHann=function(t,a){return.62-.48*Math.abs(a/(t-1)-.5)-.38*Math.cos(e.TWO_PI*a/(t-1))},d.Blackman=function(t,a,s){var i=s/2;return(1-s)/2-.5*Math.cos(e.TWO_PI*a/(t-1))+i*Math.cos(4*Math.PI*a/(t-1))},d.Cosine=function(t,e){return Math.cos(Math.PI*e/(t-1)-Math.PI/2)},d.Gauss=function(t,e,a){return Math.pow(Math.E,-.5*Math.pow((e-(t-1)/2)/(a*(t-1)/2),2))},d.Hamming=function(t,a){return.54-.46*Math.cos(e.TWO_PI*a/(t-1))},d.Hann=function(t,a){return.5*(1-Math.cos(e.TWO_PI*a/(t-1)))},d.Lanczos=function(t,e){var a=2*e/(t-1)-1;return Math.sin(Math.PI*a)/(Math.PI*a)},d.Rectangular=function(t,e){return 1},d.Triangular=function(t,e){return 2/t*(t/2-Math.abs(e-(t-1)/2))},e.mag2db=function(t){for(var e=Math.pow(10,-6),a=Math.log,s=Math.max,i=Float64Array(t.length),n=0;n<t.length;n++)i[n]=20*a(s(t[n],e));return i},e.freqz=function(t,a,s){var i,n;if(!s)for(s=Float64Array(200),i=0;i<s.length;i++)s[i]=e.TWO_PI/s.length*i-Math.PI;var r=Float64Array(s.length),l=Math.sqrt,o=Math.cos,c=Math.sin;for(i=0;i<s.length;i++){var h={real:0,imag:0};for(n=0;n<t.length;n++)h.real+=t[n]*o(-n*s[i]),h.imag+=t[n]*c(-n*s[i]);var u={real:0,imag:0};for(n=0;n<a.length;n++)u.real+=a[n]*o(-n*s[i]),u.imag+=a[n]*c(-n*s[i]);r[i]=l(h.real*h.real+h.imag*h.imag)/l(u.real*u.real+u.imag*u.imag)}return r},p.prototype.setDelayInSamples=function(t){this.delayInSamples=t,this.delayInputPointer=this.delayOutputPointer+t,this.delayInputPointer>=this.delayBufferSamples.length-1&&(this.delayInputPointer=this.delayInputPointer-this.delayBufferSamples.length)},p.prototype.setMasterVolume=function(t){this.masterVolume=t},p.prototype.setDelayVolume=function(t){this.delayVolume=t},p.prototype.process=function(t){for(var e=new Float64Array(t.length),a=0;a<t.length;a++){var s=(null===this.delayBufferSamples[this.delayOutputPointer]?0:this.delayBufferSamples[this.delayOutputPointer])*this.delayVolume+t[a];this.delayBufferSamples[this.delayInputPointer]=s,e[a]=s*this.masterVolume,this.delayInputPointer++,this.delayInputPointer>=this.delayBufferSamples.length-1&&(this.delayInputPointer=0),this.delayOutputPointer++,this.delayOutputPointer>=this.delayBufferSamples.length-1&&(this.delayOutputPointer=0)}return e},v.prototype.setDelayInSamples=function(t){this.delayInSamples=t,this.delayInputPointer=this.delayOutputPointer+t,this.delayInputPointer>=this.delayBufferSamples.length-1&&(this.delayInputPointer=this.delayInputPointer-this.delayBufferSamples.length)},v.prototype.setDelayVolume=function(t){this.delayVolume=t},v.prototype.process=function(t){for(var e=new Float64Array(t.length),a=0;a<t.length;a++){this.delayBufferSamples[this.delayInputPointer]=t[a];var s=this.delayBufferSamples[this.delayOutputPointer];e[a]=s*this.delayVolume,this.delayInputPointer++,this.delayInputPointer>=this.delayBufferSamples.length-1&&(this.delayInputPointer=0),this.delayOutputPointer++,this.delayOutputPointer>=this.delayBufferSamples.length-1&&(this.delayOutputPointer=0)}return e},y.prototype.setDelayInSamples=function(t){var e,a;for(this.delayInSamples=t,e=0;e<this.NR_OF_SINGLEDELAYS;e++)a=1+e/7,this.singleDelays[e].setDelayInSamples(Math.round(this.delayInSamples*a));for(e=0;e<this.NR_OF_MULTIDELAYS;e++)a=1+e/10,this.multiDelays[e].setDelayInSamples(Math.round(this.delayInSamples*a))},y.prototype.setMasterVolume=function(t){this.masterVolume=t},y.prototype.setMixVolume=function(t){this.mixVolume=t},y.prototype.setDelayVolume=function(t){var e;for(this.delayVolume=t,e=0;e<this.NR_OF_SINGLEDELAYS;e++)this.singleDelays[e].setDelayVolume(this.delayVolume);for(e=0;e<this.NR_OF_MULTIDELAYS;e++)this.multiDelays[e].setDelayVolume(this.delayVolume)},y.prototype.setDampFrequency=function(t){this.dampFrequency=t,this.LOWPASSL.set(t,0),this.LOWPASSR.set(t,0)},y.prototype.process=function(t){var a=new Float64Array(t.length),s=e.deinterleave(t);this.LOWPASSL.process(s[e.LEFT]),this.LOWPASSR.process(s[e.RIGHT]);var i,n=e.interleave(s[e.LEFT],s[e.RIGHT]);for(i=0;i<this.NR_OF_MULTIDELAYS;i++)a=e.mixSampleBuffers(a,this.multiDelays[i].process(n),2%i===0,this.NR_OF_MULTIDELAYS);var r=new Float64Array(a.length);for(i=0;i<this.NR_OF_SINGLEDELAYS;i++)r=e.mixSampleBuffers(r,this.singleDelays[i].process(a),2%i===0,1);for(i=0;i<r.length;i++)r[i]*=this.mixVolume;for(a=e.mixSampleBuffers(r,t,0,1),i=0;i<a.length;i++)a[i]*=this.masterVolume;return a},t&&t.exports&&(t.exports={DSP:e,DFT:i,FFT:n,RFFT:r,Sampler:l,Oscillator:o,ADSR:c,IIRFilter:h,IIRFilter2:u,WindowFunction:d,sinh:m,Biquad:f,GraphicalEq:function(t){this.FS=t,this.minFreq=40,this.maxFreq=16e3,this.bandsPerOctave=1,this.filters=[],this.freqzs=[],this.calculateFreqzs=!0,this.recalculateFilters=function(){var t=Math.round(Math.log(this.maxFreq/this.minFreq)*this.bandsPerOctave/Math.LN2);this.filters=[];for(var a=0;a<t;a++){var s=this.minFreq*Math.pow(2,a/this.bandsPerOctave),i=new f(e.PEAKING_EQ,this.FS);i.setDbGain(0),i.setBW(1/this.bandsPerOctave),i.setF0(s),this.filters[a]=i,this.recalculateFreqz(a)}},this.setMinimumFrequency=function(t){this.minFreq=t,this.recalculateFilters()},this.setMaximumFrequency=function(t){this.maxFreq=t,this.recalculateFilters()},this.setBandsPerOctave=function(t){this.bandsPerOctave=t,this.recalculateFilters()},this.setBandGain=function(t,e){if(t<0||t>this.filters.length-1)throw"The band index of the graphical equalizer is out of bounds.";if(!e)throw"A gain must be passed.";this.filters[t].setDbGain(e),this.recalculateFreqz(t)},this.recalculateFreqz=function(t){if(this.calculateFreqzs){if(t<0||t>this.filters.length-1)throw"The band index of the graphical equalizer is out of bounds. "+t+" is out of [0, "+this.filters.length-1+"]";if(!this.w){this.w=Float64Array(400);for(var a=0;a<this.w.length;a++)this.w[a]=Math.PI/this.w.length*a}var s=[this.filters[t].b0,this.filters[t].b1,this.filters[t].b2],i=[this.filters[t].a0,this.filters[t].a1,this.filters[t].a2];this.freqzs[t]=e.mag2db(e.freqz(s,i,this.w))}},this.process=function(t){for(var e=t,a=0;a<this.filters.length;a++)e=this.filters[a].process(e);return e},this.processStereo=function(t){for(var e=t,a=0;a<this.filters.length;a++)e=this.filters[a].processStereo(e);return e}},MultiDelay:p,SingleDelay:v,Reverb:y})}).call(this,a(18)(t))}},[[13,1,2]]]);